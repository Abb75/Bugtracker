{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Alexandre Brosseau/Desktop/bug_tracker/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Alexandre Brosseau/Desktop/bug_tracker/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Alexandre Brosseau/Desktop/bug_tracker/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,Fragment}from'react';import{Container,Typography,Button,Card,CardContent,Grid}from'@mui/material';import{ConfirmInvitationUserByProjectApi,DeleteGuestUserInvitationProjectApi}from'../../redux/actions/invitationActions';import{GetInvitationGuestUser}from'../../redux/selectors/invitationSelectors';import{useDispatch}from'react-redux';import{GetInvitationUser}from'../../redux/actions/invitationActions';import{GetCurrentUser}from'../../redux/selectors/userSelectors';import{GetTokenUser}from'../../redux/selectors/userSelectors';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var HandlerInvitationsPage=function HandlerInvitationsPage(){var dispatch=useDispatch();//const tokenUser = localStorage.getItem('access_token')\nvar tokenUser=GetTokenUser();var currentUser=GetCurrentUser();var invitations=GetInvitationGuestUser();var _useState=useState(invitations),_useState2=_slicedToArray(_useState,2),invitationUser=_useState2[0],setInvitationUser=_useState2[1];var handleConfirmInvitation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(invitationId,projectId,acceptInvitation){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return ConfirmInvitationUserByProjectApi(acceptInvitation,projectId,invitationId,tokenUser);case 3:dispatch(GetInvitationUser(tokenUser));_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 9:case\"end\":return _context.stop();}},_callee,null,[[0,6]]);}));return function handleConfirmInvitation(_x,_x2,_x3){return _ref.apply(this,arguments);};}();/*\r\nconst handleDeleteInvitation = async(invitation, project) => {\r\n \r\n  try{\r\n      await DeleteGuestUserInvitationProjectApi( project, invitation, tokenUser  )\r\n      dispatch(GetInvitationUser(tokenUser))\r\n  }catch(error){\r\n      console.error(error)\r\n  }\r\n}\r\n*/var handleDeleteInvitation=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(invitation,project){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return DeleteGuestUserInvitationProjectApi(project,invitation,tokenUser);case 3:dispatch(GetInvitationUser(tokenUser));_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 9:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleDeleteInvitation(_x4,_x5){return _ref2.apply(this,arguments);};}();useEffect(function(){dispatch(GetInvitationUser(tokenUser));},[dispatch]);useEffect(function(){setInvitationUser(invitations);},[invitations]);return/*#__PURE__*/_jsxs(Container,{id:\"InvitationHandler\",children:[currentUser.groups[0]==='admin'?/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"\\u200BInvitation management\"}):/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Your invitation\"}),invitationUser===null||invitationUser===void 0?void 0:invitationUser.map(function(invitation){return currentUser.groups[0]==='admin'?/*#__PURE__*/_jsx(Card,{sx:{mb:2},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",component:\"div\",children:[\"User invited : \",invitation.email]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",component:\"div\",children:[\"project : \",invitation.project]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",component:\"div\",children:[\"Role this user : \",invitation.role]}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",children:\"Waiting for confirmation...\"}),/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,justifyContent:\"flex-end\",children:/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:function onClick(){return handleDeleteInvitation(invitation.id,invitation.project_id,false);},children:\"Refuser\"})})})]})},invitation.id):/*#__PURE__*/_jsx(Card,{sx:{mb:2},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",component:\"div\",children:[\"Invitation : \",invitation.project]}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",component:\"div\",children:[\"Your role : \",invitation.role]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,justifyContent:\"flex-end\",children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:function onClick(){return handleConfirmInvitation(invitation.id,invitation.project_id,true);},children:\"Accepter\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:function onClick(){return handleConfirmInvitation(invitation.id,invitation.project_id,false);},children:\"Refuser\"})})]})]})},invitation.id);}),(invitationUser===null||invitationUser===void 0?void 0:invitationUser.length)===0&&(currentUser.groups[0]==='admin'?/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"You have not sent any invitation.\"}):/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:\"No invitations to join projects at the moment.\"}))]});};","map":{"version":3,"names":["React","useState","useEffect","Fragment","Container","Typography","Button","Card","CardContent","Grid","ConfirmInvitationUserByProjectApi","DeleteGuestUserInvitationProjectApi","GetInvitationGuestUser","useDispatch","GetInvitationUser","GetCurrentUser","GetTokenUser","HandlerInvitationsPage","dispatch","tokenUser","currentUser","invitations","invitationUser","setInvitationUser","handleConfirmInvitation","invitationId","projectId","acceptInvitation","console","error","handleDeleteInvitation","invitation","project","groups","map","mb","email","role","id","project_id","length"],"sources":["C:/Users/Alexandre Brosseau/Desktop/bug_tracker/frontend/src/components/account/ProjectInvitationsHandler.js"],"sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\r\nimport { Container, Typography, Button, Card, CardContent, Grid } from '@mui/material';\r\nimport { ConfirmInvitationUserByProjectApi, DeleteGuestUserInvitationProjectApi } from '../../redux/actions/invitationActions';\r\nimport { GetInvitationGuestUser } from '../../redux/selectors/invitationSelectors';\r\nimport { useDispatch } from 'react-redux';\r\nimport { GetInvitationUser } from '../../redux/actions/invitationActions';\r\nimport { GetCurrentUser } from '../../redux/selectors/userSelectors';\r\nimport { GetTokenUser } from '../../redux/selectors/userSelectors';\r\n\r\nexport const HandlerInvitationsPage = () => {\r\n  const dispatch = useDispatch() \r\n  //const tokenUser = localStorage.getItem('access_token')\r\n  const tokenUser = GetTokenUser()\r\n  const currentUser = GetCurrentUser()\r\n  const invitations = GetInvitationGuestUser()\r\n  const [invitationUser, setInvitationUser] = useState(invitations)\r\n \r\n  const handleConfirmInvitation = async(invitationId, projectId, acceptInvitation) => {\r\n    try{\r\n        await ConfirmInvitationUserByProjectApi(acceptInvitation, projectId,  invitationId, tokenUser)\r\n         dispatch(GetInvitationUser(tokenUser))\r\n    }catch(error){\r\n        console.error(error)\r\n    }\r\n}\r\n\r\n/*\r\nconst handleDeleteInvitation = async(invitation, project) => {\r\n \r\n  try{\r\n      await DeleteGuestUserInvitationProjectApi( project, invitation, tokenUser  )\r\n      dispatch(GetInvitationUser(tokenUser))\r\n  }catch(error){\r\n      console.error(error)\r\n  }\r\n}\r\n*/\r\n\r\nconst handleDeleteInvitation = async(invitation, project) => {\r\n \r\n  try{\r\n      await DeleteGuestUserInvitationProjectApi( project, invitation, tokenUser  )\r\n      dispatch(GetInvitationUser(tokenUser))\r\n  }catch(error){\r\n      console.error(error)\r\n  }\r\n}\r\n\r\n\r\nuseEffect(() => {\r\n  dispatch(GetInvitationUser(tokenUser))\r\n}, [dispatch])\r\n\r\n\r\n \r\n\r\nuseEffect(() => {\r\n  setInvitationUser(invitations);\r\n}, [invitations]);\r\n\r\n\r\n  return (\r\n    <Container id='InvitationHandler'>\r\n        {currentUser.groups[0] === 'admin' ? (\r\n      <Typography variant=\"h4\" gutterBottom>\r\n                â€‹Invitation management\r\n              </Typography> ) : (<Typography variant=\"h4\" gutterBottom>\r\n                Your invitation\r\n              </Typography>)}\r\n\r\n\r\n\r\n      {invitationUser?.map((invitation) => (\r\n        currentUser.groups[0] === 'admin' ? (\r\n        \r\n          <Card key={invitation.id} sx={{ mb: 2 }}>\r\n           \r\n          <CardContent>\r\n            <Typography variant=\"h6\" component=\"div\">\r\n              User invited : {invitation.email}\r\n            </Typography>\r\n            <Typography variant=\"h6\" component=\"div\">\r\n              project : {invitation.project}\r\n            </Typography>\r\n            <Typography variant=\"h6\" component=\"div\">\r\n              Role this user : {invitation.role}\r\n            </Typography> \r\n             <Typography variant=\"h6\" component=\"div\">\r\n                Waiting for confirmation...\r\n            </Typography>\r\n            <Grid container spacing={2} justifyContent=\"flex-end\">\r\n              \r\n              <Grid item>\r\n                <Button\r\n                  variant=\"outlined\"\r\n                  color=\"secondary\"\r\n                  onClick={() => handleDeleteInvitation(invitation.id, invitation.project_id, false)}\r\n                >\r\n                  Refuser\r\n                </Button>\r\n              \r\n              </Grid>\r\n            </Grid>\r\n          </CardContent>\r\n        </Card>\r\n\r\n\r\n\r\n        ) : ( \r\n       \r\n          <Card key={invitation.id} sx={{ mb: 2 }}>\r\n            \r\n          <CardContent>\r\n            <Typography variant=\"h6\" component=\"div\">\r\n              Invitation : {invitation.project}\r\n            </Typography>\r\n            <Typography variant=\"h6\" component=\"div\">\r\n              Your role : {invitation.role}\r\n            </Typography>\r\n            <Grid container spacing={2} justifyContent=\"flex-end\">\r\n              <Grid item>\r\n                <Button\r\n                  variant=\"contained\"\r\n                  color=\"primary\"\r\n                  onClick={() => handleConfirmInvitation(invitation.id, invitation.project_id,  true)}\r\n                >\r\n                  Accepter\r\n                </Button>\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  variant=\"outlined\"\r\n                  color=\"secondary\"\r\n                  onClick={() => handleConfirmInvitation(invitation.id, invitation.project_id, false)}\r\n                >\r\n                  Refuser\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </CardContent>\r\n        </Card>\r\n\r\n\r\n\r\n        )\r\n        \r\n      ))}\r\n\r\n   \r\n      {invitationUser?.length === 0 && (\r\n            currentUser.groups[0] === 'admin' ? (<Typography variant=\"body1\">\r\n              You have not sent any invitation.\r\n           </Typography>) : (  <Typography variant=\"body1\">\r\n         No invitations to join projects at the moment.\r\n        </Typography> )\r\n\r\n      \r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}